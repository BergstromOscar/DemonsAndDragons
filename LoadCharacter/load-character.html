<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PVQPC4Q6');</script>
    <!-- End Google Tag Manager -->

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Load Character</title>
    <link rel="stylesheet" href="../style.css">
    <style>
        /* Center buttons and place them next to each other */
        .button-container {
            display: flex;
            justify-content: center;
            gap: 10px; /* Space between buttons */
            margin-top: 20px; /* Space above buttons */
        }
        /* Style for the form inputs */
        #stats-form {
            display: flex;
            justify-content: space-between;
            padding: 20px;
            max-width: 75%;
            margin: auto; /* Center the form */
        }
        .column {
            width: 48%; /* Adjusted width for better spacing */
        }
        .section {
            background-color: rgba(47, 53, 47, 0.8); /* Transparent grey background */
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
        }
        .attribute-field {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        label {
            display: inline-block;
            width: 45%;
            font-weight: bold;
            color: white;
        }
        input[type="text"],
        input[type="number"] {
            width: 55%; /* Adjusted width for better spacing */
            padding: 5px;
            box-sizing: border-box;
            border: none;
            border-bottom: 2px solid white;
            background: none;
            color: white;
            outline: none;
        }
        input[type="number"] {
            text-align: right;
        }
        /* Popup style */
        .popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 8px;
            z-index: 1000;
        }
        .popup-content {
            color: white;
        }
        .popup-content ul {
            list-style-type: none;
            padding: 0;
        }
        .popup-content ul li {
            margin-bottom: 10px;
        }
        .popup-content button {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PVQPC4Q6"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <header>
        <h1>Load Character</h1>
    </header>
    <main>
        <!-- Popup for character selection -->
        <div class="popup" id="character-popup">
            <div class="popup-content">
                <h2>Select a Character to Load or Delete</h2>
                <ul id="character-list"></ul>
                <button id="close-popup-button">Close</button>
            </div>
        </div>
        <form id="dnd-stats-form" style="display:none;">
            <label for="character-name">Character Name:</label>
            <input type="text" id="character-name" name="character-name" readonly><br><br>
            <label for="strength">Strength:</label>
            <input type="number" id="strength" name="strength"><br><br>
            <label for="dexterity">Dexterity:</label>
            <input type="number" id="dexterity" name="dexterity"><br><br>
            <label for="constitution">Constitution:</label>
            <input type="number" id="constitution" name="constitution"><br><br>
            <label for="intelligence">Intelligence:</label>
            <input type="number" id="intelligence" name="intelligence"><br><br>
            <label for="wisdom">Wisdom:</label>
            <input type="number" id="wisdom" name="wisdom"><br><br>
            <label for="charisma">Charisma:</label>
            <input type="number" id="charisma" name="charisma"><br><br>
            <button type="button" id="load-character-button">Load Character</button>
        </form>
        <button onclick="window.location.href='../index.html'">Back to Home</button>
    </main>
    <footer>
        <p>&copy; 2024 Demons And Dragons</p>
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            displayCharacterList();
        });

        function displayCharacterList() {
            var characterList = document.getElementById('character-list');
            var characters = getCharacterListFromLocalStorage();
            characters.forEach(function(character) {
                var listItem = document.createElement('li');
                listItem.textContent = character.name;
                listItem.addEventListener('click', function() {
                    loadCharacterData(character);
                    document.getElementById('character-popup').style.display = 'none';
                });
                characterList.appendChild(listItem);
            });
            document.getElementById('character-popup').style.display = 'block';
            document.getElementById('close-popup-button').addEventListener('click', function() {
                document.getElementById('character-popup').style.display = 'none';
            });
        }

        function loadCharacterData(character) {
            document.getElementById('character-name').value = character.name;
            document.getElementById('strength').value = character.strength;
            document.getElementById('dexterity').value = character.dexterity;
            document.getElementById('constitution').value = character.constitution;
            document.getElementById('intelligence').value = character.intelligence;
            document.getElementById('wisdom').value = character.wisdom;
            document.getElementById('charisma').value = character.charisma;
            document.getElementById('dnd-stats-form').style.display = 'block';
        }

        function getCharacterListFromLocalStorage() {
            var characterList = [];
            for (var i = 0; i < localStorage.length; i++) {
                var key = localStorage.key(i);
                if (key.startsWith('character-')) {
                    var characterData = JSON.parse(localStorage.getItem(key));
                    characterList.push({
                        id: key,
                        name: characterData.Name                    });
                }
            }
            return characterList;
        }

        function saveStats() {
            var inputs = document.querySelectorAll("#dnd-stats-form input");
            var characterData = {};
            inputs.forEach(function(input) {
                var attributeName = input.getAttribute("id");
                var attributeValue = input.value;
                characterData[attributeName] = attributeValue;
            });

            // Create a unique ID based on character name and timestamp
            var characterName = characterData["character-name"];
            var currentTime = new Date().getTime();
            var characterID = characterName.replace(/\s+/g, '-') + "-" + currentTime;

            // Save character data to local storage
            localStorage.setItem('character-' + characterID, JSON.stringify(characterData));

            // Redirect to home page
            window.location.href = '../index.html';
        }
    </script>
</body>
</html>

